# Структура тестов для Auth компонентов

## auth.service.spec.ts
Тесты для AuthService.

### Регистрация
- [x] Успешная регистрация
- [x] Создание JWT токена
- [ ] Проверка уникальности email
- [x] Валидация данных регистрации
- [x] Хеширование пароля

### Аутентификация
- [x] Успешная аутентификация
- [x] Проверка пароля
- [x] Создание JWT токена
- [x] Обработка неверного email
- [x] Обработка неверного пароля

### JWT токены
- [x] Генерация access token
- [ ] Генерация refresh token
- [x] Валидация токенов
- [ ] Обновление токенов
- [ ] Отзыв токенов
- [x] Проверка payload токена

### Сессии
- [ ] Создание сессии
- [ ] Проверка активной сессии
- [ ] Завершение сессии
- [ ] Очистка устаревших сессий
- [ ] Множественные сессии пользователя

## ws-jwt.guard.spec.ts
Тесты для WebSocket JWT Guard.

### Валидация подключений
- [x] Успешная валидация токена
- [x] Отказ при отсутствии токена
- [x] Отказ при невалидном токене
- [ ] Отказ при истекшем токене
- [x] Проверка формата токена

### Извлечение данных
- [x] Получение userId из токена
- [ ] Получение ролей из токена
- [ ] Проверка scope токена
- [x] Обработка кастомных claims

### Интеграция с Socket.IO
- [x] Внедрение в handshake
- [x] Доступ к данным в middleware
- [x] Обработка ошибок подключения
- [x] Логирование попыток доступа

## auth.controller.spec.ts
Тесты для AuthController.

### Endpoints
- [ ] POST /auth/register
- [ ] POST /auth/login
- [ ] POST /auth/refresh
- [ ] POST /auth/logout
- [ ] GET /auth/me

### Валидация запросов
- [ ] Валидация тела запроса
- [ ] Валидация заголовков
- [ ] Обработка невалидных данных
- [ ] Проверка типов данных

### Ответы
- [ ] Успешные ответы
- [ ] Ошибки валидации
- [ ] Ошибки аутентификации
- [ ] Ошибки авторизации
- [ ] Формат токенов в ответе

## auth.integration.spec.ts
Интеграционные тесты аутентификации.

### Полный цикл аутентификации
- [ ] Регистрация пользователя
- [ ] Вход в систему
- [ ] Использование токена
- [ ] Обновление токена
- [ ] Выход из системы

### Сценарии безопасности
- [ ] Попытки брутфорса
- [ ] Множественные сессии
- [ ] Одновременный доступ
- [ ] Отзыв токенов
- [ ] Rate limiting

## Утилиты для тестирования
- [x] Создание тестовых токенов
- [x] Создание тестовых пользователей
- [x] Эмуляция JWT
- [x] Мокирование сервисов
- [ ] Хелперы для проверки авторизации
